
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.66.0" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
<link rel="stylesheet" href="../css/normalize.css">
<link rel="stylesheet" href="../css/skeleton.css">
<link rel="stylesheet" href="../css/custom.css">
<link rel="alternate" href="index.xml" type="application/rss+xml" title="Speech Research">
<link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
<title>CycleGAN for Instrument Transfer</title>
</head>
<body>

<div class="container">

	<header role="banner">
		
			
		
		
	</header>


	<main role="main">
		<article itemscope itemtype="https://schema.org/BlogPosting">
            <h1 class="entry-title" itemprop="headline">Music Style Transfer with CycleGANs</h1>
            <h2 id="course">Final Project, Northwestern University CS496: Deep Generative Models by Professor Bryan Pardo</h2>
			<section itemprop="entry-text">
				<br>
<h2 id="authors">By</h2>
<ul>
<li>Rohin Nanavati <a href="mailto:rohinnanavati2023@u.northwestern.edu">rohinnanavati2023@u.northwestern.edu</a> </li>
<li>David McDevitt <a href="mailto:davidmcdevitt2023@u.northwestern.edu">davidmcdevitt2023@u.northwestern.edu</a> </li>
<li>Shruthi Hariharan <a href="mailto:shruthihariharan2023@u.northwestern.edu">shruthihariharan2023@u.northwestern.edu</a> </li>

</ul>
<h2 id="abstract">Description</h2>
<p>
Image style transfer is a popular task where visible features from on image are transferred to another image. In audio, these transferrable features are not obvious enough, and we wanted to see if we could train a model to learn them and do this through image representations and not audio.
Our project aims to perform audio style transfer: in our case, this refers to translating sound played on one instrument to another. We particularly focused on doing this in a manner similar to image style transfer, by using an image representation of audio - spectrograms. We then use CycleGANs for the image-to-image translation. We use BigVGAN for spectrogram-audio conversion.
First, we create our own dataset by converting ~3 hours of Beethoven piano pieces in MIDI files to their nylon string guitar versions. 
For the resulting audio, we split them into chunks of 5.47 seconds and passed them through the Data Loader module of BigVGAN to compute mel spectrograms in the format Big VGAN accepts. 
Then, we pass our model through CycleGAN (modified slightly to work on rectangular image rather than square images) and train our two discriminators, one from piano to guitar audio and the other from guitar to piano. CycleGAN works on cycle-consistency loss, in which the original audio is passed through both the generators (generator 1: original to converted style -> generator 2: converted to original style) to get reconstructed audio. The loss is the L1-norm of the difference in reconstructed and original audio.
Our CycleGAN model outputs spectrograms, which need to be converted back to audio. For this we use a pre-trained Vocoder BigVGAN. We showcase our test cases and an out-of-dataset real-world example (The piano intro to Colplay's 'Clocks'). </p>

<h2> Architecture Pipeline</h2>
<img src="architecture_cyclegan.jpg"></img> 

<h2 id="baseline-samples">Samples</h2>

  <table width="100%" border="1">
      <tbody>
        <tr>
          <th width="22%" style="text-align: center" scope="col">Audio (Piano to Guitar)</th>
          <th width="40%" style="text-align: center" scope="col">Description</th>
        </tr>
        
      
        <tr>
          <td width="26%" style="text-align: center">
            <audio controls="controls">
                <source src="clip_1433_real_A_generated_e2e.wav" autoplay="">Your browser does not support the audio element.
            </audio>
          <td width="26%" style="text-align: left">
            <p>Real A (Original Piano audio)</p>
        </tr>
        <tr>
          <td width="26%" style="text-align: center">
            <audio controls="controls">
                <source src="clip_1433_rec_A_generated_e2e.wav" autoplay="">Your browser does not support the audio element.
            </audio>
          <td width="26%" style="text-align: left">
            <p>Piano audio reconstructed by Generator B</p>
        </tr>
        <tr>
          <td width="26%" style="text-align: center">
            <audio controls="controls">
                <source src="clip_1433_fake_B_generated_e2e.wav" autoplay="">Your browser does not support the audio element.
            </audio>
          <td width="26%" style="text-align: left">
            <p>Guitar version of Real A (Piano), generated by Generator A</p>
        </tr>
        <tr>
          <th width="22%" style="text-align: center" scope="col">Audio (Guitar to Piano)</th>
          <th width="40%" style="text-align: center" scope="col">Description</th>
        </tr>
        
        <tr>
          <td width="26%" style="text-align: center">
            <audio controls="controls">
                <source src="clip_1433_real_B_generated_e2e.wav" autoplay="">Your browser does not support the audio element.
            </audio>
          <td width="26%" style="text-align: left">
            <p>Real B (Original Guitar audio)</p>
        </tr>
        <tr>
          <td width="26%" style="text-align: center">
            <audio controls="controls">
                <source src="clip_1433_rec_B_generated_e2e.wav" autoplay="">Your browser does not support the audio element.
            </audio>
          <td width="26%" style="text-align: left">
            <p>Guitar audio reconstructed by Generator A</p>
        </tr>
        <tr>
          <td width="26%" style="text-align: center">
            <audio controls="controls">
                <source src="clip_1433_fake_A_generated_e2e.wav" autoplay="">Your browser does not support the audio element.
            </audio>
          <td width="26%" style="text-align: left">
            <p>Piano version of Real B (Guitar), generated by Generator B</p>
        </tr>
      </tbody>
  </table>

  <table width="100%" border="1">
    <tbody>
      <tr>
        <th width="22%" style="text-align: center" scope="col">Piano Audio Input ('Clocks' by Coldplay)</th>
        <th width="40%" style="text-align: center" scope="col">Guitar Audio Output</th>
      </tr>
      
    
      <tr>
        <td width="26%" style="text-align: center">
          <audio controls="controls">
              <source src="Clocks_piano.wav" autoplay="">Your browser does not support the audio element.
          </audio>
        <td width="26%" style="text-align: center">
          <audio controls="controls">
            <source src="Clocks_guitar.wav" autoplay="">Your browser does not support the audio element.
      </tr>
    </tbody>
    </table>
</body>
</html>